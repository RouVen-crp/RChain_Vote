{
  "version": 3,
  "sources": ["../../vuetify/src/components/VMenu/VMenu.tsx"],
  "sourcesContent": ["// Styles\nimport './VMenu.sass'\n\n// Components\nimport { VDialogTransition } from '@/components/transitions'\nimport { VDefaultsProvider } from '@/components/VDefaultsProvider'\nimport { VOverlay } from '@/components/VOverlay'\nimport { makeVOverlayProps } from '@/components/VOverlay/VOverlay'\n\n// Composables\nimport { forwardRefs } from '@/composables/forwardRefs'\nimport { useProxiedModel } from '@/composables/proxiedModel'\nimport { useScopeId } from '@/composables/scopeId'\n\n// Utilities\nimport { computed, inject, mergeProps, nextTick, provide, ref, shallowRef, watch } from 'vue'\nimport { VMenuSymbol } from './shared'\nimport { focusableChildren, focusChild, genericComponent, getNextElement, getUid, omit, propsFactory, useRender } from '@/util'\n\n// Types\nimport type { Component } from 'vue'\nimport type { OverlaySlots } from '@/components/VOverlay/VOverlay'\n\nexport const makeVMenuProps = propsFactory({\n  // TODO\n  // disableKeys: Boolean,\n  id: String,\n\n  ...omit(makeVOverlayProps({\n    closeDelay: 250,\n    closeOnContentClick: true,\n    locationStrategy: 'connected' as const,\n    openDelay: 300,\n    scrim: false,\n    scrollStrategy: 'reposition' as const,\n    transition: { component: VDialogTransition as Component },\n  }), ['absolute']),\n}, 'VMenu')\n\nexport const VMenu = genericComponent<OverlaySlots>()({\n  name: 'VMenu',\n\n  props: makeVMenuProps(),\n\n  emits: {\n    'update:modelValue': (value: boolean) => true,\n  },\n\n  setup (props, { slots }) {\n    const isActive = useProxiedModel(props, 'modelValue')\n    const { scopeId } = useScopeId()\n\n    const uid = getUid()\n    const id = computed(() => props.id || `v-menu-${uid}`)\n\n    const overlay = ref<VOverlay>()\n\n    const parent = inject(VMenuSymbol, null)\n    const openChildren = shallowRef(0)\n    provide(VMenuSymbol, {\n      register () {\n        ++openChildren.value\n      },\n      unregister () {\n        --openChildren.value\n      },\n      closeParents () {\n        setTimeout(() => {\n          if (!openChildren.value) {\n            isActive.value = false\n            parent?.closeParents()\n          }\n        }, 40)\n      },\n    })\n\n    async function onFocusIn (e: FocusEvent) {\n      const before = e.relatedTarget as HTMLElement | null\n      const after = e.target as HTMLElement | null\n\n      await nextTick()\n\n      if (\n        isActive.value &&\n        before !== after &&\n        overlay.value?.contentEl &&\n        // We're the topmost menu\n        overlay.value?.globalTop &&\n        // It isn't the document or the menu body\n        ![document, overlay.value.contentEl].includes(after!) &&\n        // It isn't inside the menu body\n        !overlay.value.contentEl.contains(after)\n      ) {\n        const focusable = focusableChildren(overlay.value.contentEl)\n        focusable[0]?.focus()\n      }\n    }\n\n    watch(isActive, val => {\n      if (val) {\n        parent?.register()\n        document.addEventListener('focusin', onFocusIn, { once: true })\n      } else {\n        parent?.unregister()\n        document.removeEventListener('focusin', onFocusIn)\n      }\n    })\n\n    function onClickOutside () {\n      parent?.closeParents()\n    }\n\n    function onKeydown (e: KeyboardEvent) {\n      if (props.disabled) return\n\n      if (e.key === 'Tab') {\n        const nextElement = getNextElement(\n          focusableChildren(overlay.value?.contentEl as Element, false),\n          e.shiftKey ? 'prev' : 'next',\n          (el: HTMLElement) => el.tabIndex >= 0\n        )\n        if (!nextElement) {\n          isActive.value = false\n          overlay.value?.activatorEl?.focus()\n        }\n      }\n    }\n\n    function onActivatorKeydown (e: KeyboardEvent) {\n      if (props.disabled) return\n\n      const el = overlay.value?.contentEl\n      if (el && isActive.value) {\n        if (e.key === 'ArrowDown') {\n          e.preventDefault()\n          focusChild(el, 'next')\n        } else if (e.key === 'ArrowUp') {\n          e.preventDefault()\n          focusChild(el, 'prev')\n        }\n      } else if (['ArrowDown', 'ArrowUp'].includes(e.key)) {\n        isActive.value = true\n        e.preventDefault()\n        setTimeout(() => setTimeout(() => onActivatorKeydown(e)))\n      }\n    }\n\n    const activatorProps = computed(() =>\n      mergeProps({\n        'aria-haspopup': 'menu',\n        'aria-expanded': String(isActive.value),\n        'aria-owns': id.value,\n        onKeydown: onActivatorKeydown,\n      }, props.activatorProps)\n    )\n\n    useRender(() => {\n      const overlayProps = VOverlay.filterProps(props)\n\n      return (\n        <VOverlay\n          ref={ overlay }\n          class={[\n            'v-menu',\n            props.class,\n          ]}\n          style={ props.style }\n          { ...overlayProps }\n          v-model={ isActive.value }\n          absolute\n          activatorProps={ activatorProps.value }\n          onClick:outside={ onClickOutside }\n          onKeydown={ onKeydown }\n          { ...scopeId }\n        >\n          {{\n            activator: slots.activator,\n            default: (...args) => (\n              <VDefaultsProvider root=\"VMenu\">\n                { slots.default?.(...args) }\n              </VDefaultsProvider>\n            ),\n          }}\n        </VOverlay>\n      )\n    })\n\n    return forwardRefs({ id, ΨopenChildren: openChildren }, overlay)\n  },\n})\n\nexport type VMenu = InstanceType<typeof VMenu>\n"],
  "mappings": "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",
  "names": ["makeVMenuProps", "propsFactory", "id", "String", "omit", "makeVOverlayProps", "closeDelay", "closeOnContentClick", "locationStrategy", "openDelay", "scrim", "scrollStrategy", "transition", "component", "VDialogTransition", "VMenu", "genericComponent", "name", "props", "emits", "value", "setup", "_ref", "slots", "isActive", "useProxiedModel", "scopeId", "useScopeId", "uid", "getUid", "computed", "overlay", "ref", "parent", "inject", "VMenuSymbol", "openChildren", "shallowRef", "provide", "register", "unregister", "closeParents", "setTimeout", "onFocusIn", "e", "before", "relatedTarget", "after", "target", "nextTick", "contentEl", "globalTop", "document", "includes", "contains", "focusable", "focusableChildren", "focus", "watch", "val", "addEventListener", "once", "removeEventListener", "onClickOutside", "onKeydown", "disabled", "key", "nextElement", "getNextElement", "shiftKey", "el", "tabIndex", "activatorEl", "onActivatorKeydown", "preventDefault", "focusChild", "activatorProps", "mergeProps", "useRender", "overlayProps", "VOverlay", "filterProps", "_createVNode", "_mergeProps", "class", "style", "$event", "activator", "default", "_len", "arguments", "length", "args", "Array", "_key", "VDefaultsProvider", "forwardRefs", "ΨopenChildren"]
}
